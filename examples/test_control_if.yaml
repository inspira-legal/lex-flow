workflows:
  - name: main
    interface:
      inputs: []
      outputs: []
    variables:
      x: 10
      y: 5
    nodes:
      start:
        opcode: workflow_start
        next: print_header
        inputs: {}

      print_header:
        opcode: io_print
        next: test_if_true
        inputs:
          STRING:
            literal: "=== Testing control_if (without else) ===\n\n"

      # Test 1: Condition is true (should execute THEN branch)
      test_if_true:
        opcode: control_if
        next: test_if_false
        inputs:
          CONDITION:
            node: check_x_greater
          THEN:
            branch: print_x_is_greater

      check_x_greater:
        opcode: operator_greater_than
        isReporter: true
        inputs:
          OPERAND1:
            variable: x
          OPERAND2:
            variable: y

      print_x_is_greater:
        opcode: io_print
        next: null
        inputs:
          STRING:
            literal: "✓ Test 1 passed: x is greater than y (10 > 5)\n"

      # Test 2: Condition is false (should skip THEN branch)
      test_if_false:
        opcode: control_if
        next: print_after_skip
        inputs:
          CONDITION:
            node: check_y_greater
          THEN:
            branch: print_y_is_greater

      check_y_greater:
        opcode: operator_greater_than
        isReporter: true
        inputs:
          OPERAND1:
            variable: y
          OPERAND2:
            variable: x

      print_y_is_greater:
        opcode: io_print
        next: null
        inputs:
          STRING:
            literal: "✗ Test 2 FAILED: This should not print!\n"

      print_after_skip:
        opcode: io_print
        next: test_if_with_next
        inputs:
          STRING:
            literal: "✓ Test 2 passed: THEN branch was correctly skipped (5 not > 10)\n"

      # Test 3: control_if with next node continues correctly
      test_if_with_next:
        opcode: control_if
        next: print_continued
        inputs:
          CONDITION:
            node: check_always_true
          THEN:
            branch: print_in_then

      check_always_true:
        opcode: operator_equals
        isReporter: true
        inputs:
          OPERAND1:
            literal: 1
          OPERAND2:
            literal: 1

      print_in_then:
        opcode: io_print
        next: null
        inputs:
          STRING:
            literal: "✓ Test 3a: Executed THEN branch\n"

      print_continued:
        opcode: io_print
        next: print_footer
        inputs:
          STRING:
            literal: "✓ Test 3b: Continued to next node after control_if\n"

      print_footer:
        opcode: io_print
        next: null
        inputs:
          STRING:
            literal: "\n✅ All control_if tests passed!\n"
